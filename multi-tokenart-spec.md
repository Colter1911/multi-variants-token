# Multi Token Art ‚Äî –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è –º–æ–¥—É–ª—è –¥–ª—è Foundry VTT v13

## 1. –û–±—â–µ–µ –æ–ø–∏—Å–∞–Ω–∏–µ

**–ù–∞–∑–≤–∞–Ω–∏–µ –º–æ–¥—É–ª—è:** `multi-tokenart`  
**–°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å:** Foundry VTT v13+ (—Å—Ç—Ä–æ–≥–æ)  
**System-agnostic:** –î–∞  
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–º–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º–∏ —Ç–æ–∫–µ–Ω–∞ –∏ –ø–æ—Ä—Ç—Ä–µ—Ç–∞ –∞–∫—Ç—ë—Ä–∞ —Å —Å–∏—Å—Ç–µ–º–æ–π –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è –ø–æ HP, –∫–∞—Å—Ç–æ–º–Ω—ã–º —Å–∫—Ä–∏–ø—Ç–∞–º, random-—Ä–µ–∂–∏–º–æ–º –∏ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–µ–π —Å Dynamic Token Ring.

## 2. –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö

### 2.1 –ì–∏–±—Ä–∏–¥–Ω–æ–µ —Ö—Ä–∞–Ω–µ–Ω–∏–µ (Actor + Token)
- `actor.flags['multi-tokenart']` ‚Äî –∏—Å—Ç–æ—á–Ω–∏–∫ –∏—Å—Ç–∏–Ω—ã, –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –∏ –Ω–∞—Å—Ç—Ä–æ–µ–∫.
- `token.flags['multi-tokenart']` ‚Äî —Ç–æ–ª—å–∫–æ –∞–∫—Ç–∏–≤–Ω—ã–µ IDs –∏ —Å–ª—É–∂–µ–±–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ —Ç–æ–∫–µ–Ω–∞.

### 2.2 –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö
- `version`, `global` (`autoRotate`, `tokenRandom`, `portraitRandom`)
- `tokenImages[]` –∏ `portraitImages[]` (–¥–æ 100)
- –¥–ª—è token images –µ—Å—Ç—å `dynamicRing`
- –¥–ª—è token flags: `activeTokenImageId`, `activePortraitImageId`, `originalRing`

### 2.3 HP-–∞—Ç—Ä–∏–±—É—Ç (System-Agnostic)
- `game.settings('multi-tokenart', 'hpCurrentPath')`
- `game.settings('multi-tokenart', 'hpMaxPath')`
- –∞–≤—Ç–æ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø—Ä–µ—Å–µ—Ç–æ–≤ –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –∑–∞–ø—É—Å–∫–µ —Å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å—é —Ä—É—á–Ω–æ–π –Ω–∞—Å—Ç—Ä–æ–π–∫–∏.

## 3. –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ –±–ª–æ–∫–∏

### 3.1 –ö–æ–Ω—Ç–µ–∫—Å—Ç–Ω–æ–µ –º–µ–Ω—é —Ç–æ–∫–µ–Ω–∞
- –ö–Ω–æ–ø–∫–∞ ¬´–ú–µ–Ω–µ–¥–∂–µ—Ä –ø–æ—Ä—Ç—Ä–µ—Ç–æ–≤¬ª (üé≠), –¥–æ—Å—Ç—É–ø–Ω–∞ GM/Owner.
- Hook: `Hooks.on('getTokenActionButtons', ...)`

### 3.2 –û—Å–Ω–æ–≤–Ω–æ–µ –æ–∫–Ω–æ –º–µ–Ω–µ–¥–∂–µ—Ä–∞
- `ApplicationV2`, –Ω–µ–º–æ–¥–∞–ª—å–Ω–æ–µ, —Ä–µ—Å–∞–π–∑–∞–±–µ–ª—å–Ω–æ–µ.
- –ó–∞–≥–æ–ª–æ–≤–æ–∫: `Multi Art: [Actor Name]`
- –°–µ–∫—Ü–∏–∏ Token/Portrait —Å random/refresh, glow –∞–∫—Ç–∏–≤–Ω–æ–≥–æ, default label, edit settings.

### 3.3 –ê–≤—Ç–æ–∞–∫—Ç–∏–≤–∞—Ü–∏—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç: customScript > wounded > die. 
- Random –æ—Ç–∫–ª—é—á–∞–µ—Ç –∞–≤—Ç–æ–∞–∫—Ç–∏–≤–∞—Ü–∏—é.
- –î–ª—è wounded: –≤—ã–±–∏—Ä–∞—Ç—å –Ω–∞–∏–º–µ–Ω—å—à–∏–π –ø–æ–¥—Ö–æ–¥—è—â–∏–π –ø–æ—Ä–æ–≥, –ø—Ä–∏ —Ä–∞–≤–µ–Ω—Å—Ç–≤–µ ‚Äî —Å–ª—É—á–∞–π–Ω–æ.
- –ï—Å–ª–∏ –Ω–µ—Ç –∫–∞–Ω–¥–∏–¥–∞—Ç–æ–≤: –æ—Å—Ç–∞–≤–∏—Ç—å —Ç–µ–∫—É—â–µ–µ / –≤–µ—Ä–Ω—É—Ç—å default.

### 3.4 Dynamic Token Ring
- –ü—Ä–∏ –∞–∫—Ç–∏–≤–∞—Ü–∏–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è —Å `dynamicRing.enabled` –ø–µ—Ä–µ–∑–∞–ø–∏—Å—ã–≤–∞—Ç—å ring.
- –•—Ä–∞–Ω–∏—Ç—å –∏ –≤–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—Ç—å –æ—Ä–∏–≥–∏–Ω–∞–ª (`originalRing`) –ø—Ä–∏ –¥–µ–∞–∫—Ç–∏–≤–∞—Ü–∏–∏.

### 3.5 Drag & Drop –∏ –∑–∞–≥—Ä—É–∑–∫–∞
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ FilePicker –∏ D&D —Ñ–∞–π–ª–æ–≤.
- –ü–∞–ø–∫–∞ `[Data]/multi-tokenart/[ActorSlug]/` —Å –∞–≤—Ç–æ—Å–æ–∑–¥–∞–Ω–∏–µ–º.
- –§–æ—Ä–º–∞—Ç—ã: webp/png/jpg/jpeg/gif/svg/avif.

### 3.6 –ü–µ—Ä–µ—É–ø–æ—Ä—è–¥–æ—á–∏–≤–∞–Ω–∏–µ
- Drag-n-drop –≤–Ω—É—Ç—Ä–∏ —Å–µ–∫—Ü–∏–∏ —Å –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ–º `sort`.

### 3.7 Default-–∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ
- –¢–æ–ª—å–∫–æ –æ–¥–Ω–æ default –Ω–∞ —Ç–∏–ø.
- –î–ª—è –Ω–æ–≤—ã—Ö —Ç–æ–∫–µ–Ω–æ–≤: default –ø—Ä–∏ random off, random image –ø—Ä–∏ random on.

### 3.8 –ü—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞
- GM + Owner: –ø–æ–ª–Ω—ã–π –¥–æ—Å—Ç—É–ø.
- Observer: –±–µ–∑ –¥–æ—Å—Ç—É–ø–∞.

## 4. –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ñ–∞–π–ª–æ–≤
–ò—Å–ø–æ–ª—å–∑—É–µ–º —Å—Ç—Ä—É–∫—Ç—É—Ä—É —Å `scripts/`, `templates/`, `styles/`, `lang/`, `module.json`.

## 5. –•—É–∫–∏
- `init`, `ready`, `getTokenActionButtons`, `updateActor`, `updateToken`, `createToken`, `renderActorSheet`.

## 6. –í–∏–∑—É–∞–ª—å–Ω—ã–π —Å—Ç–∏–ª—å
- –¢–µ–º–Ω–∞—è —Ç–µ–º–∞ + –∑–æ–ª–æ—Ç–æ–π –∞–∫—Ü–µ–Ω—Ç + cyan/red —Å–æ—Å—Ç–æ—è–Ω–∏—è.

## 7. module.json
- `id: multi-tokenart`, `esmodules: [scripts/module.mjs]`, `styles`, `languages`, `socket: true`, compat v13.

## 8. –ö—Ä–∞–µ–≤—ã–µ —Å–ª—É—á–∞–∏
- –õ–∏–º–∏—Ç 100 –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π.
- Unicode slugify fallback –Ω–∞ actor.id.
- Random –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–Ω–µ–µ default.
- Last write wins.

## 9. –§–∞–∑—ã
1) –§—É–Ω–¥–∞–º–µ–Ω—Ç
2) UI
3) –ë–∞–∑–æ–≤–∞—è –ª–æ–≥–∏–∫–∞
4) –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è
5) –†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
6) –ü–æ–ª–∏—Ä–æ–≤–∫–∞

---

–≠—Ç–æ—Ç –¥–æ–∫—É–º–µ–Ω—Ç —è–≤–ª—è–µ—Ç—Å—è —Ä–∞–±–æ—á–∏–º –∫–∞–Ω–æ–Ω–æ–º –¥–ª—è —Ç–µ–∫—É—â–µ–≥–æ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è.
